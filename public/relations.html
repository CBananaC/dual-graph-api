<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>關係圖 - 我的論文</title>
    <!-- Noto Sans TC -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <!-- vis-network & Font Awesome -->
    <script src="https://cdn.jsdelivr.net/npm/vis-network@9.1.2/dist/vis-network.min.js"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Chart.js（只用來畫長條圖）-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- ECharts（用來畫 Pack Layout 氣泡圖） -->
       <!--  <script src="https://d3js.org/d3.v7.min.js"></script> -->

    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>
<body>
  <header>
    <nav class="tab-bar">
      <a href="introduction.html" class="tab-button">引言</a>
      <a href="relations.html"    class="tab-button active">關係圖</a>
      <a href="timeline.html"     class="tab-button">時間線</a>
      <a href="text.html"         class="tab-button">現文</a>
      <a href="conclusion.html"   class="tab-button">結論</a>
    </nav>
  </header>

  <main class="content">
    <h1>指證關係圖</h1>

    <!-- 指控關係圖 身份篩選 -->
    <div class="filter-panel">
      <span>1. 篩選身份：</span>
      <div class="button-group">
        <button class="filter-button filter-identity-button" data-identity="全部">全部</button>
        <button class="filter-button filter-identity-button" data-identity="藍玉">藍玉</button>
        <button class="filter-button filter-identity-button" data-identity="功臣">牽涉藍玉案的功臣</button>
        <button class="filter-button filter-identity-button" data-identity="胡惟庸功臣">牽涉胡惟庸案的功臣</button>
        <button class="filter-button filter-identity-button" data-identity="都督">都督</button>
        <button class="filter-button filter-identity-button" data-identity="親屬">功臣都督的親屬</button>
        <button class="filter-button filter-identity-button" data-identity="僕役">功臣都督的僕役</button>
      </div>
    </div>

    <!-- 指控關係圖 與 資訊面板 -->
    <section class="container">
      <div id="accusationGraph" class="graph"></div>
      <aside id="infoPanel" class="info-panel">
        請點擊人物或關係查看詳細資訊
      </aside>
    </section>

    <!-- 指控者/被指控者 切換 -->
    <div class="filter-panel">
      <span>2. 該人物作為：</span>
      <div class="button-group">
        <button id="accuserButton" class="filter-button">
          <i class="fas fa-user-tie"></i> 指控者
        </button>
        <button id="accusedButton" class="filter-button">
          <i class="fas fa-user-injured"></i> 被指控者
        </button>
      </div>
    </div>

    <h1>證供關係圖</h1>
    <!-- 證供關係圖 篩選 & 重置 -->
    <div class="filter-panel">
      <span>3. 篩選罪名：</span>
      <div class="button-group">
        <button id="showAllButton" class="filter-button">
          <i class="fas fa-eye"></i> 重置關係圖
        </button>
        <button class="filter-button filter-testimony-button" data-label="全部">全部證供關係</button>
        <button class="filter-button filter-testimony-button" data-label="透露謀反動機">透露謀反動機</button>
        <button class="filter-button filter-testimony-button" data-label="透露謀反計劃">透露謀反計劃</button>
        <button class="filter-button filter-testimony-button" data-label="邀約謀反">邀約謀反</button>
        <button class="filter-button filter-testimony-button" data-label="答應參與謀反">答應參與謀反</button>
        <button class="filter-button filter-testimony-button" data-label="聯絡">聯絡</button>
        <button class="filter-button filter-testimony-button" data-label="秘密商議">秘密商議</button>
        <button class="filter-button filter-testimony-button" data-label="要求隱暪謀反">要求隱暪謀反</button>
        <button class="filter-button filter-testimony-button" data-label="聚兵預備謀反">聚兵預備謀反</button>
        <button class="filter-button filter-testimony-button" data-label="兵馬">屯積兵馬</button>
        <button class="filter-button filter-testimony-button" data-label="參與胡惟庸謀反">參與胡惟庸謀反</button>
        <button class="filter-button filter-testimony-button" data-label="事敗">藍玉事敗後</button>
      </div>
    </div>

    <!-- 證供關係圖 與 資訊面板 -->
    <section class="container">
      <div id="testimonyGraph" class="graph"></div>
      <aside id="infoPanelTestimony" class="info-panel">
        請點擊人物或關係查看詳細資訊
      </aside>
    </section>

    <!-- 新增長條圖 + 氣泡圖容器 -->
    <div class="chart-container" style="width:100%;margin-top:20px;">
      <!-- 長條圖 -->
      <canvas id="testimonyBarChart"></canvas>
      <!-- D3 Pack Layout 氣泡圖 -->
      <div id="testimonyBubbleChart"></div>
    </div>
  </main>

  <!-- 放在 body 底部 -->
  <script src="script.js"></script>
</body>
</html>
